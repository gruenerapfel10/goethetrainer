# MUA Data Architecture Documentation

## Overview

MUA uses a modular JSON-based architecture for managing university data and academic systems. This document outlines the complete data structure including both the university requirements system and the file organization changes implemented in January 2025.

## Major Architectural Changes (January 2025)

### File Structure Transformation

**Previous Architecture**:
- Single monolithic `500.json` file containing all 500 universities
- University detail pages loaded entire dataset to find one university
- Inefficient loading and poor performance

**Current Architecture**:
- **Master Index**: `500.json` contains all universities with basic info and IDs
- **Individual Files**: Each university has its own JSON file (e.g., `mit.json`, `stanford.json`)
- **Direct Loading**: University detail pages load only the required individual file
- **Optimized Performance**: Faster loading and better caching

### UI Component Architecture Evolution (August 2025)

**SwipeableWidget Integration**:
- **Interactive Bento Grid**: Cards now use SwipeableWidget for multi-view content
- **Swipeable Cards**: Rankings, requirements, tuition, language tests, deadlines, and scholarships
- **Data-Driven Views**: Each widget adapts to available data dynamically
- **Enhanced UX**: Users can swipe through different perspectives of the same data category

### File Organization

```
/public/
├── 500.json                    # Master index with all universities + IDs
├── mit.json                    # Individual university files
├── stanford.json               
├── harvard.json
├── oxford.json
├── cambridge.json
├── imperial.json
└── [285+ more university files]
```

### Data Structure Evolution

**Previous Issues**:
- Hardcoded field expectations in UI components
- Bento grid assumed specific field names that didn't exist
- Mismatched schema between countries

**Current Implementation**:
- **Data-Driven UI**: Bento grid adapts to actual data structure
- **Country-Specific Fields**: Different field names properly handled per country
- **Consistent Schema**: Preserved actual field names from source data

## Current Data Structure

### Master Index File (500.json)

Contains all universities with basic information and navigation IDs:

```json
[
  {
    "id": "mit",                         // Unique identifier for individual file
    "name": "Massachusetts Institute of Technology",
    "country": "United States of America",
    "rank": 1,
    "employer_reputation_rank": 2,
    "academic_reputation_rank": 4,
    "supported_degrees": ["aerospace-eng", "ai-ml", "comp-science", ...]
  }
]
```

### Individual University Files (2025-26 Updated)

Each university has its own JSON file (e.g., `mit.json`, `stanford.json`) containing complete data:

```json
{
  "id": "mit",
  "name": "Massachusetts Institute of Technology",
  "country": "United States of America", 
  "rank": 1,
  "employer_reputation_rank": 2,
  "academic_reputation_rank": 4,
  "supported_degrees": ["array of degree IDs"],
  
  "tuition_2025_26": {
    "estimated": "$60,100",
    "total_cost": "$85,960"
  },
  
  "us": { /* US nationals data */ },
  "in": { /* Indian nationals data */ },
  "gb": { /* UK nationals data */ },
  "ru": { /* Russian nationals data */ }
}
```

## Actual Field Structure by Country

Our data preserves the authentic requirements structure from each university, adapting to real-world variations rather than forcing artificial standardization.

### Academic Requirements by Country

**United States (`us`):**
```json
"academic_requirements": {
  "gpa_minimum": "3.9/4.0",
  "standardized_tests": ["SAT", "ACT"],
  "sat_scores": { "average": 1543 },
  "act_scores": { "average": 35 },
  "ap_courses": "recommended"
}
```

**India (`in`):**
```json
"academic_requirements": {
  "class_12_percentage": "95%+ (CBSE/ISC)",
  "required_subjects": ["Physics", "Chemistry", "Mathematics"],
  "standardized_tests": ["SAT", "ACT"],
  "sat_scores": { "average": 1570, "math": "790-800" },
  "extracurriculars": "Research, leadership, innovation valued"
}
```

**United Kingdom (`gb`):**
```json
"academic_requirements": {
  "a_levels": "A*A*A or equivalent",
  "gcse": "mostly A*/A grades", 
  "ib": "42-45 points",
  "subject_requirements": ["Mathematics", "Sciences"]
}
```

**Russia (`ru`):**
```json
"academic_requirements": {
  "diploma": "Gold Medal or equivalent",
  "unified_state_exam": "top 5%",
  "international_curriculum": "IB 42+ or A-levels A*A*A"
}
```

### Language Requirements Structure

**Common Structure Across Countries:**
```json
"language_requirements": {
  "english_proficiency": "required|native|native_or_equivalent",
  "tests_required": ["TOEFL", "IELTS"] | [],
  "minimum_scores": {
    "toefl": 100,
    "ielts": 7.0,
    "duolingo": 125
  },
  "exemptions": "English medium education for 4+ years"
}
```

### Visa Requirements Structure (Standardized 2025)

**All International Students:**
```json
"visa_requirements": {
  "visa_type": "F-1 Student Visa|Student Visa (Tier 4)|Student Permit (Type C/D)|Student Pass",
  "processing_time": "2-3 weeks after admission",
  "visa_application_fee": "$185|£348|CHF 100|SGD 90",
  "sevis_fee": "$350",  // US only
  "healthcare_surcharge": "£470 per year",  // UK only
  "health_insurance": "Mandatory",  // Switzerland
  "medical_examination": "Required",  // Singapore
  "financial_proof_required": "$85,960 for first year",
  "visa_interview_tips": "Prepare for academic goals discussion",
  "success_rate": "~95% for university admits"
}
```

### Tuition Structure (2025-26 Updated)

**Current Academic Year Rates:**
```json
"tuition_2025_26": {
  "domestic": "$59,320|£9,250|CHF 730 per semester|SGD 8,250",
  "international": "$59,320|£28,370-£38,700|CHF 2,190 per semester|SGD 18,900",
  "estimated": "$60,000+",
  "total_cost": "$85,000-$95,000",
  "application_fee": "$75|£27.50|CHF 150|SGD 20"
}
```

### Scholarship Opportunities Structure

**Need-Based Aid:**
```json
"need_based": {
  "available": true,
  "percentage_receiving": "58%",
  "average_award": "$59,000", 
  "income_threshold": "family income under $90,000 for full aid",
  "application_required": true,
  "additional_forms": ["CSS Profile", "FAFSA"]
}
```

**Merit-Based Scholarships:**
```json
"merit_based": {
  "available": true,
  "scholarships": [
    {
      "name": "President's Scholarship",
      "amount": "full tuition + stipend",
      "criteria": "exceptional academic merit"
    }
  ],
  "description": "Limited merit scholarships available"
}
```

**Research & Work Study:**
```json
"research_opportunities": {
  "undergraduate_research": true,
  "paid_positions": "85% of positions are paid",
  "funding_available": "$2,000-$5,000 per semester"
},
"work_study": {
  "available": true,
  "typical_hours": "8-12 hours per week", 
  "hourly_wage": "$15-$20"
}
```

## Frontend Architecture Changes

### Data-Driven Bento Grid with SwipeableWidget

The university detail page now uses a completely redesigned bento grid with interactive swipeable components:

**Previous Approach** (Static):
```javascript
// ❌ Old - static single-view cards
<BentoGridItem 
  title="Rankings"
  description={<div>#{university.rank}</div>}
/>
```

**Current Approach** (Interactive SwipeableWidget):
```javascript  
// ✅ New - interactive multi-view swipeable cards
<BentoGridItem
  header={
    <SwipeableWidget
      title={<div className="flex items-center gap-3"><Trophy className="h-5 w-5" />Rankings</div>}
      views={[
        {
          id: 'global',
          hasData: !!university.rank,
          content: (
            <div className="text-center">
              <div className="text-6xl font-bold text-blue-600">#{university.rank}</div>
              <div className="text-sm text-white/70">Global Rank</div>
            </div>
          )
        },
        {
          id: 'employer',
          hasData: !!university.employer_reputation_rank,
          content: (
            <div className="text-center">
              <div className="text-6xl font-bold text-white">#{university.employer_reputation_rank}</div>
              <div className="text-sm text-white/70">Employer Reputation</div>
            </div>
          )
        }
      ]}
    />
  }
/>
```

### SwipeableWidget Architecture

**Component Structure:**
- **Title**: Icon + descriptive title for the data category
- **Views Array**: Multiple perspectives of the same data category
- **hasData Validation**: Only show views with actual data
- **Responsive Design**: Touch swipe on mobile, button navigation on desktop

**Data-Driven Views:**
```javascript
// Academic Requirements - Multiple views based on nationality
views: [
  { id: 'grades', hasData: !!(gpa_minimum || class_12_percentage || a_levels) },
  { id: 'tests', hasData: !!(sat_scores || act_scores) },
  { id: 'courses', hasData: !!(ap_courses || ib_score) }
]

// Language Requirements - Test-specific views  
views: [
  { id: 'ielts', hasData: !!minimum_scores?.ielts },
  { id: 'toefl', hasData: !!minimum_scores?.toefl },
  { id: 'duolingo', hasData: !!minimum_scores?.duolingo },
  { id: 'not-required', hasData: english_proficiency === 'native_or_equivalent' }
]
```

### Performance Improvements

**Loading Optimization:**
- **Before**: Load entire 500.json (6390 lines) to find one university
- **After**: Load individual university file (~400 lines)
- **Result**: ~94% reduction in data transfer per page load

**Navigation Improvements:**
- **Before**: URLs like `/universities/1` (rank-based)
- **After**: URLs like `/universities/mit` (ID-based)
- **Result**: More semantic URLs and direct file mapping

## Implementation Status & Migration

### File Generation Summary
- **Total Universities**: 500 in master index
- **Individual Files Created**: 285 successfully generated
- **Success Rate**: 57% (remaining files blocked by special characters)
- **Top Universities**: All top 50 have individual files ✅

### Files Successfully Created
All major universities have individual JSON files including:
- Top 10 global universities: ✅ Complete 
- Major US universities: ✅ MIT, Stanford, Harvard, Caltech, etc.
- Major UK universities: ✅ Oxford, Cambridge, Imperial, UCL, etc.
- Other top-tier institutions: ✅ ETH Zurich, NUS, etc.

### Data Quality Verification (2025-26 Updated)
- ✅ All top 10 universities updated with current 2025-26 data
- ✅ Standardized visa requirements across all international nationalities  
- ✅ Current tuition rates with `tuition_2025_26` field structure
- ✅ Updated deadlines for 2025-26 application cycle
- ✅ Comprehensive language requirements (no "Check website" placeholders)
- ✅ SwipeableWidget integration for enhanced user experience
- ✅ Authentication integration with star/save functionality

## Future Improvements

### Remaining File Generation
- **Priority**: Generate remaining 215 individual university files
- **Challenge**: Handle special characters in university names
- **Solution**: Improve filename sanitization algorithm

### Data Enhancement
- **Expand Coverage**: Add more country-specific requirements
- **Program-Specific**: Different requirements per major
- **Real-Time Updates**: Sync with university websites

### Performance Optimization  
- **Caching Strategy**: Implement service worker caching
- **Lazy Loading**: Load sections on demand
- **CDN Distribution**: Distribute individual files via CDN

## Technical Implementation

### Frontend Integration

**University List Page** (`/app/universities/page.tsx`):
```javascript
// Loads master index for browsing
fetch('/500.json').then(res => res.json())

// Navigation uses university IDs
router.push(`/universities/${university.id}`)
```

**University Detail Page** (`/app/universities/[id]/page.tsx`):
```javascript
// Loads individual university file directly
fetch(`/${params.id}.json`).then(res => res.json())

// Data-driven bento grid adapts to available fields
{getAcademicRequirements()?.gpa_minimum && (
  <div>GPA: {getAcademicRequirements()?.gpa_minimum}</div>
)}
```

### API Usage Examples

```javascript
// Get university by ID  
const university = await fetch('/mit.json').then(r => r.json())

// Get requirements for specific nationality
const requirements = university.ru?.requirements

// Get scholarship opportunities
const scholarships = university.in?.scholarship_opportunities

// Check data availability
const hasRussianData = university.ru !== undefined
```

## Conclusion

The architectural transformation from monolithic to modular structure with SwipeableWidget integration provides significant benefits:

**Performance**: 94% reduction in data transfer per university page
**Maintainability**: Individual files easier to update and manage  
**Scalability**: New universities can be added without affecting existing files
**Flexibility**: UI adapts to actual data structure rather than forcing artificial schemas
**User Experience**: Interactive swipeable cards with multi-perspective data views
**Data Accuracy**: Current 2025-26 tuition, deadlines, and comprehensive visa requirements
**Standardization**: Consistent visa and language requirement structure across all universities

This foundation supports MUA's goal of providing accurate, up-to-date, interactive university information tailored to students from different countries and educational backgrounds with an engaging, modern interface. 

